(()=>{var e={};e.id=696,e.ids=[696],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},5240:e=>{"use strict";e.exports=require("https")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},2707:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),t(1503),t(2550),t(5866),t(5080);var a=t(3191),r=t(8716),i=t(7922),l=t.n(i),n=t(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let d=["",{children:["(user)",{children:["availability",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,1503)),"C:\\PROJECT\\pool-reservation-frontend\\app\\(user)\\availability\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2550)),"C:\\PROJECT\\pool-reservation-frontend\\app\\(user)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,5080)),"C:\\PROJECT\\pool-reservation-frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\PROJECT\\pool-reservation-frontend\\app\\(user)\\availability\\page.tsx"],u="/(user)/availability/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(user)/availability/page",pathname:"/availability",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3101:(e,s,t)=>{Promise.resolve().then(t.bind(t,4546))},5585:(e,s,t)=>{Promise.resolve().then(t.bind(t,6447))},4546:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var a=t(326),r=t(7577),i=t(2353),l=t(4071),n=t(9781),o=t(9729),d=t(8019),c=t(1405),u=t(7358),m=t(8998);let x=(0,t(2881).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var p=t(4061),h=t(5663),v=t(6824);let g=e=>{if(!e||!e.includes(":"))return"";let[s,t]=e.split(":"),a=parseInt(s,10);return`${0===a?12:a>12?a-12:a}:${t} ${a>=12?"PM":"AM"}`},y=[{time:"06:00",available:!0},{time:"07:00",available:!0},{time:"08:00",available:!0},{time:"09:00",available:!0},{time:"10:00",available:!0},{time:"11:00",available:!0},{time:"12:00",available:!0},{time:"13:00",available:!0},{time:"14:00",available:!0},{time:"15:00",available:!0},{time:"16:00",available:!0},{time:"17:00",available:!0},{time:"18:00",available:!0},{time:"19:00",available:!0},{time:"20:00",available:!0},{time:"21:00",available:!0},{time:"22:00",available:!0}];function j(){let[e,s]=(0,r.useState)(new Date),[t,j]=(0,r.useState)(""),[b,f]=(0,r.useState)("1"),[N,P]=(0,r.useState)("1"),[C,S]=(0,r.useState)(!1),[w,M]=(0,r.useState)(!1),[q,E]=(0,r.useState)(!1),[k,R]=(0,r.useState)(new Date),[_,T]=(0,r.useState)(null),[Z,A]=(0,r.useState)(!0),[G,O]=(0,r.useState)([]),[$,F]=(0,r.useState)(!1),[I,z]=(0,r.useState)(null),[D,J]=(0,r.useState)(null),U=(0,r.useMemo)(()=>{let e=_?.max_guests||10;return Array.from({length:null!==D?Math.min(D,e):e},(e,s)=>({value:String(s+1),label:`${s+1} Guest${s+1>1?"s":""}`}))},[_,D]),H=(e,s)=>{if((0,i.R)((0,l.b)(s),(0,l.b)(k)))return!1;if(!(0,n.z)(s))return!0;let[t,a]=e.split(":").map(Number);return 60*t+a>=60*k.getHours()+k.getMinutes()+30},W=(0,r.useMemo)(()=>y.map(s=>{let t=G.find(e=>e.time===s.time),a=H(s.time,e);return{...s,available:a&&!t?.isFull&&!t?.isBlocked,isFull:t?.isFull||!1,isBlocked:t?.isBlocked||!1,availableSpots:t?.availableSpots,currentGuests:t?.currentGuests,lessonParticipants:t?.lessonParticipants,maxCapacity:t?.maxCapacity}}),[e,k,G]),B=(e,s)=>{if(!e||!e.includes(":"))return"";let t=e.split(":"),a=parseInt(t[0],10)||0,r=parseInt(t[1],10)||0;return`${(a+s).toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`},[L,Y]=(0,r.useState)(!1),V=async()=>{if(t){S(!0),z(null),Y(!1);try{await v.PG.create({date:(0,o.WU)(e,"yyyy-MM-dd"),startTime:t,endTime:B(t,parseInt(N)),guests:parseInt(b)}),E(!0),M(!1),j("")}catch(t){console.error("Reservation failed:",t);let e=t.response?.data?.message||"Failed to create reservation. Please try again.",s=t.response?.data?.isPendingConflict||!1;z(e),Y(s),M(!1)}finally{S(!1)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Pool Availability"}),a.jsx("p",{className:"text-gray-500 mt-1",children:"Select a date and time to make a reservation"})]}),_&&a.jsx("div",{className:"p-4 rounded-xl bg-primary-50 border border-primary-200",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[a.jsx(d.Z,{className:"h-5 w-5 text-primary-600 mt-0.5"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-primary-900",children:"Pool Capacity Information"}),a.jsx("p",{className:"text-sm text-primary-700 mt-1",children:null!==D?(0,a.jsxs)(a.Fragment,{children:["Your maximum guests per reservation: ",(0,a.jsxs)("strong",{children:[D," guest",1!==D?"s":""]})]}):(0,a.jsxs)(a.Fragment,{children:["Maximum guests allowed per reservation: ",(0,a.jsxs)("strong",{children:[_.max_guests||10," guests"]})]})})]})]})}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 rounded border border-gray-200 bg-white"}),a.jsx("span",{className:"text-gray-600",children:"Available"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 rounded bg-red-100 border border-red-200"}),a.jsx("span",{className:"text-gray-600",children:"Full"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 rounded bg-gray-200"}),a.jsx("span",{className:"text-gray-600",children:"Blocked"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 rounded bg-gray-100"}),a.jsx("span",{className:"text-gray-600",children:"Past/Unavailable"})]})]}),q&&(0,a.jsxs)("div",{className:"p-4 rounded-xl bg-success-50 border border-success-200 text-success-700",children:[a.jsx("p",{className:"font-medium",children:"Reservation request submitted!"}),a.jsx("p",{className:"text-sm mt-1",children:"You'll receive a notification once it's approved."})]}),I&&(0,a.jsxs)("div",{className:`p-4 rounded-xl border ${L?"bg-amber-50 border-amber-200 text-amber-700":"bg-red-50 border-red-200 text-red-700"}`,children:[a.jsx("p",{className:"font-medium",children:L?"Pending Request Exists":"Reservation Failed"}),a.jsx("p",{className:"text-sm mt-1",children:I}),L&&a.jsx("p",{className:"text-sm mt-2",children:a.jsx("a",{href:"/my-reservations",className:"underline font-medium hover:no-underline",children:"View your pending reservations â†’"})})]}),(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsx(h.f,{selectedDate:e,onDateSelect:e=>{s(e),j(""),E(!1),z(null)}})}),(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:`Available Times for ${(0,o.WU)(e,"EEEE, MMMM d")}`,subtitle:(0,n.z)(e)?`Reservations require at least 30 minutes advance booking. Current time: ${(0,o.WU)(k,"h:mm a")}`:"Select a time slot to reserve"}),$?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[a.jsx(c.Z,{className:"h-6 w-6 animate-spin text-primary-600"}),a.jsx("span",{className:"ml-2 text-gray-500",children:"Loading availability..."})]}):a.jsx(h.cr,{slots:W,selectedTime:t,onSelect:j,formatTime:g,showCapacity:!0})]}),t&&(0,a.jsxs)(h.Zb,{children:[a.jsx(h.Ol,{title:"Reservation Details"}),(0,a.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[a.jsx(h.Ph,{id:"guests",label:"Number of Guests",options:U,value:b,onChange:e=>f(e.target.value)}),a.jsx(h.Ph,{id:"duration",label:"Duration",options:[{value:"1",label:"1 Hour"},{value:"2",label:"2 Hours"},{value:"3",label:"3 Hours"}],value:N,onChange:e=>P(e.target.value)})]}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Reservation Summary"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(u.Z,{className:"h-4 w-4"}),a.jsx("span",{children:(0,o.WU)(e,"EEEE, MMMM d, yyyy")})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(m.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[g(t)," ",a.jsx(x,{className:"h-3 w-3 inline"})," ",g(B(t,parseInt(N)))]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[a.jsx(p.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[b," guest(s)"]})]})]})]}),a.jsx(h.zx,{className:"w-full mt-4",onClick:()=>M(!0),children:"Request Reservation"})]})]})]}),a.jsx(h.u_,{isOpen:w,onClose:()=>M(!1),title:"Confirm Reservation",children:(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:"Are you sure you want to request this reservation?"}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-xl space-y-2 text-sm",children:[(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Date:"})," ",(0,o.WU)(e,"EEEE, MMMM d, yyyy")]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Time:"})," ",g(t)," - ",g(B(t,parseInt(N)))]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"Guests:"})," ",b]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx(h.zx,{variant:"outline",className:"flex-1",onClick:()=>M(!1),children:"Cancel"}),a.jsx(h.zx,{className:"flex-1",onClick:V,loading:C,children:"Confirm"})]})]})})]})}},6447:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(326),r=t(3136),i=t(97),l=t(5663),n=t(5047),o=t(7577);function d({children:e}){let{user:s,isLoading:t,isAuthenticated:d,logout:c}=(0,r.a)();(0,n.useRouter)();let[u,m]=(0,o.useState)(!1);return t||!u?a.jsx(l.wY,{}):s&&"admin"!==s.role?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(i.w,{user:s,onLogout:c}),a.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})]}):null}},8998:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(2881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1405:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(2881).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},1503:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\PROJECT\pool-reservation-frontend\app\(user)\availability\page.tsx#default`)},2550:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`C:\PROJECT\pool-reservation-frontend\app\(user)\layout.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[391,773,971,226,989,97],()=>t(2707));module.exports=a})();